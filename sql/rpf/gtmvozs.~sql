SELECT
 Rownum as "Номер"
, t.*
FROM ( SELECT 
     count(v.well_name) as "номер скважины"
   , sum(v.lr_bs) as "Qж до ост-ки"
   , sum(round(v.or_bs,1)) as "Qн до ост-ки"
   , v.dl_bs as "Hд до ост-ки"
   , v.stop_date as "Дата ост-ки"
   , v.sr_name as "Причина отс-ки"
   , v.mrp as "Наработка на отказ"
   , v.sr_d_name as "мероприятие"
   , sum(v.lrc) as "Qж расч."
   , sum(round(v.orc,1)) as "Qн расч."
   , sum(round((v.orc - v.or_bs),1)) as "Прирост"
   , v.r_comment as "комментарий"   /*Из Реестра ТКРС*/
   , (trunc(to_date('##.##.####',  'dd.mm.yyyy')) - trunc(v.stop_date)) as "Дн. в простое"
   , (trunc(to_date('##.##.####',  'dd.mm.yyyy')) - trunc(v.mo_date)) as "Дн. в кат."
   , v.wt_req_name as "вид гтм"
   , v.well_id well_id
   , v.mo_date mo_date
  , v.stop_date stop_date
  , v.state_curr state_curr
  , v.state_rem
  , v.sr_id  /*Код причины остановки*/
  , v.sr_d_id
  , v.r_sost_n 
  from 
   ef9.fo_hsod v
   where v.DT = to_date('##.##.####',  'dd.mm.yyyy')) t
WHERE
    t.state_rem = 'Ремонтный'
 AND t.sr_id = 21    /*Код причины остановки*/
 AND t.sr_d_id  in(71,69) 
 AND t.mo_date is null
